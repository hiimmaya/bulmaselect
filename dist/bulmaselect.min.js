"use strict";const englishLocale={btnNoSelection:"Nothing selected",searchPlaceholder:"Search"},defaultStyle=".ms-textbox{width:270px;align-items:middle;justify-content:center;justify-self:center;text-align:center;display:block;margin-top:5px;margin-left:5px;margin-right:5px}.ms-ul{list-style-type:none;margin-left:5px!important;margin-top:3px!important;margin-bottom:3px}.ms-button{color:#fff;height:2.5em;line-height:1.5;width:300px;height:40px;text-align:left;font-size:1em;background-color:#fff;border-color:#dbdbdb;border-radius:4px;color:#363636;z-index:55}.ms-drop{background-color:#fff;position:absolute;color:#363636;width:300px;height:300px;max-width:300px;max-height:300px;overflow:auto!important;z-index:55}.select:after{z-index:0!important}.ms-group{font-weight:700}.ms-span{margin-left:5px}.ms-label{text-overflow:ellipsis!important;display:block}",defaultConfig={isOpen:!1,keepOpen:!1,injectStyle:!0,btnMaxLabels:3,btnDelimiter:",",searchEnable:!1,locale:englishLocale,options:["a","b","c"]};class Bulmaselect{constructor(e,t=defaultConfig){if("string"==typeof e&&(e=document.getElementById(e)),!e)throw new Error("No parent element");if("SELECT"===e.nodeName){t.options=[],Array.from(e.children).forEach((e=>{e.innerText&&t.options.push(e.innerText)}));const n=document.createElement("div");e.parentNode.replaceChild(n,e),e=n}if((t={...defaultConfig,...t}).options=t.options.map((e=>"string"==typeof e?{label:e}:"group"===e.type?(e.children=e.children.map((e=>"string"==typeof e?{label:e}:e)),e):e)),t.injectStyle){const e=document.createElement("style");e.textContent=defaultStyle,document.head.append(e)}const n=document.createElement("button");n.classList="ms-button",n.innerText=t.label,e.appendChild(n);const o=document.createElement("div");o.classList="ms-drop",o.hidden=!t.isOpen&&!t.keepOpen;const s=document.createElement("ul");if(s.classList="ms-ul",e.appendChild(o),t.searchEnable){const e=document.createElement("input");e.classList="ms-textbox",e.placeholder=t.locale.searchPlaceholder,o.appendChild(e),e.addEventListener("input",(()=>this.updateFilter())),this.search=e}o.appendChild(s),s.addEventListener("click",(e=>this.updateButton())),n.addEventListener("click",(()=>t.keepOpen?null:o.hidden=!o.hidden)),t.options.forEach(((e,n)=>{const o=document.createElement("label");o.classList="ms-label";const i=document.createElement("span");i.classList="ms-span",i.innerText=e.label,s.appendChild(o);const a=document.createElement("input");a.type="checkbox",a.classList="ms-checkbox",o.appendChild(a),"group"===e.type?(e.children.forEach(((e,o)=>{const i=document.createElement("label");i.classList="ms-label";const a=document.createElement("span");a.classList="ms-span",a.innerText=e.label,s.appendChild(i);const l=document.createElement("input");l.type="checkbox",l.classList="ms-checkbox",Object.defineProperty(t.options[n].children[o],"state",{get:()=>l.checked,set:e=>{if("boolean"!=typeof e)throw new Error("You can't set this property to a non-boolean");l.checked=e,this.updateButton()}}),t.options[n].children[o].el=i,t.options[n].children[o].checkbox=l,i.appendChild(l),i.appendChild(a)})),Object.defineProperty(t.options[n],"state",{get:()=>!t.options[n].children.map((e=>e.state)).includes(!1),set:e=>{if("boolean"!=typeof e)throw new Error("You can't set this property to a non-boolean");t.options[n].children.forEach((t=>t.state=e)),a.checked=e,this.updateButton()}}),i.classList="ms-span ms-group",o.classList=a.classList+" ms-group-label",a.addEventListener("click",(e=>{t.options[n].state=!t.options[n].state}))):Object.defineProperty(t.options[n],"state",{get:()=>a.checked,set:e=>{if("boolean"!=typeof e)throw new Error("You can't set this property to a non-boolean");a.checked=e,this.updateButton()}}),o.appendChild(i),t.options[n].checkbox=a,t.options[n].el=o})),this.parent=e,this.config=t,this.options=t.options,this.button=n,this.dropdown=o,this.ul=s,this.updateButton()}getSelected(){this.updateSelections();const e=[];return this.options.map((e=>Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e)))).forEach((t=>{if("group"===t.type){const n=[];t.children.forEach((e=>e.state&&n.push(e))),n.length&&(t.children=n,e.push(t))}else t.state&&e.push(t)})),e}updateButton(){let e=this.getSelected();e.forEach(((t,n)=>{if("group"===t.type){if(e.splice(n,1),t.state)return e.push(t);e=e.concat(t.children)}})),e.length?this.button.innerText=`${e.slice(0,this.config.btnMaxLabels).map((e=>e.label)).join(this.config.btnDelimiter)}${e.length>this.config.btnMaxLabels?"...":""}`:this.button.innerText=this.config.locale.btnNoSelection}updateSelections(){this.options.forEach((e=>{"group"===e.type&&(e.checkbox.checked=e.state)}))}updateFilter(){if(!this.search&&!this.search.value.length)return;const e=this.search.value.toLowerCase();this.options.forEach((t=>{if("group"===t.type){t.children.forEach((t=>{const n=!t.label.toLowerCase().startsWith(e);Array.from(t.el.children).forEach((e=>e.hidden=n)),t.hidden=n}));const n=t.children.map((e=>e.hidden)).includes(!1);Array.from(t.el.children).forEach((e=>e.hidden=!n))}else{const n=!t.label.toLowerCase().startsWith(e);Array.from(t.el.children).forEach((e=>e.hidden=n))}}))}update(){this.updateSelections(),this.updateButton(),this.updateFilter()}}