"use strict";const englishLocale={btnNoSelection:"Nothing selected",searchPlaceholder:"Filter"},defaultStyle=".ms-ul{padding:0;margin:0;list-style-type:none}.ms-li{padding:none}#ms > div > ul > label{width:100%;display:block;cursor:pointer}.ms-button{background-color:#363636;color:#fff;border-color:transparent;cursor:pointer;border-width:1px;border-radius:4px;border-radius:4px;border-style:solid;height:2.5em;line-height:1.5;width:185px}.ms-drop{background-color:#363636;position:absolute;margin-top:-1px;border:1px solid #aaa;width:183px;max-height:249px;font-weight:400;border-style:solid;border-color:transparent;border-top-color:#000;border-radius:4px;color:#fff;max-height:250px;overflow:auto}.ms-group{font-weight:700}",defaultConfig={isOpen:!1,keepOpen:!1,injectStyle:!0,btnMaxLabels:3,btnDelimiter:",",searchEnable:!1,locale:englishLocale,options:["a","b","c"]};class Bulmaselect{constructor(e,t=defaultConfig){if("string"==typeof e&&(e=document.getElementById(e)),!e)throw new Error("No parent element");if("SELECT"===e.nodeName){t.options=[],Array.from(e.children).forEach((e=>{e.innerText&&t.options.push(e.innerText)}));const o=document.createElement("div");e.parentNode.replaceChild(o,e),e=o}if((t={...defaultConfig,...t}).options=t.options.map((e=>"string"==typeof e?{label:e}:"group"===e.type?(e.children=e.children.map((e=>"string"==typeof e?{label:e}:e)),e):e)),t.injectStyle){const e=document.createElement("style");e.textContent=defaultStyle,document.head.append(e)}const o=document.createElement("button");o.classList="ms-button",o.innerText=t.label,e.appendChild(o);const n=document.createElement("div");n.classList="ms-drop",n.hidden=!t.isOpen&&!t.keepOpen;const s=document.createElement("ul");if(s.classList="ms-ul",e.appendChild(n),t.searchEnable){const e=document.createElement("input");e.classList="ms-textbox",e.placeholder=t.locale.searchPlaceholder,n.appendChild(e),e.addEventListener("input",(()=>this.updateFilter())),this.search=e}n.appendChild(s),s.addEventListener("click",(e=>this.updateButton())),o.addEventListener("click",(()=>t.keepOpen?null:n.hidden=!n.hidden)),t.options.forEach(((e,o)=>{const n=document.createElement("label");n.classList="ms-label";const i=document.createElement("span");i.classList="ms-span",i.innerText=e.label,s.appendChild(n);const r=document.createElement("input");r.type="checkbox",r.classList="ms-checkbox",n.appendChild(r),"group"===e.type?(e.children.forEach(((e,n)=>{const i=document.createElement("label");i.classList="ms-label";const r=document.createElement("span");r.classList="ms-span",r.innerText=e.label,s.appendChild(i);const a=document.createElement("input");a.type="checkbox",a.classList="ms-checkbox",Object.defineProperty(t.options[o].children[n],"state",{get:()=>a.checked,set:e=>{if("boolean"!=typeof e)throw new Error("You can't set this property to a non-boolean");a.checked=e,this.updateButton()}}),t.options[o].children[n].el=i,t.options[o].children[n].checkbox=a,i.appendChild(a),i.appendChild(r)})),Object.defineProperty(t.options[o],"state",{get:()=>!t.options[o].children.map((e=>e.state)).includes(!1),set:e=>{if("boolean"!=typeof e)throw new Error("You can't set this property to a non-boolean");t.options[o].children.forEach((t=>t.state=e)),r.checked=e,this.updateButton()}}),i.classList="ms-span ms-group",n.classList=r.classList+" ms-group-label",r.addEventListener("click",(e=>{t.options[o].state=!t.options[o].state}))):Object.defineProperty(t.options[o],"state",{get:()=>r.checked,set:e=>{if("boolean"!=typeof e)throw new Error("You can't set this property to a non-boolean");r.checked=e,this.updateButton()}}),n.appendChild(i),t.options[o].checkbox=r,t.options[o].el=n})),this.parent=e,this.config=t,this.options=t.options,this.button=o,this.dropdown=n,this.ul=s,this.updateButton()}getSelected(){this.updateSelections();const e=[];return this.options.map((e=>Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e)))).forEach((t=>{if("group"===t.type){const o=[];t.children.forEach((e=>e.state&&o.push(e))),o.length&&(t.children=o,e.push(t))}else t.state&&e.push(t)})),e}updateButton(){let e=this.getSelected();e.forEach(((t,o)=>{if("group"===t.type){if(e.splice(o,1),t.state)return e.push(t);e=e.concat(t.children)}})),e.length?this.button.innerText=`${e.slice(0,this.config.btnMaxLabels).map((e=>e.label)).join(this.config.btnDelimiter)}${e.length>this.config.btnMaxLabels?"...":""}`:this.button.innerText=this.config.locale.btnNoSelection}updateSelections(){this.options.forEach((e=>{"group"===e.type&&(e.checkbox.checked=e.state)}))}updateFilter(){if(!this.search&&!this.search.value.length)return;const e=this.search.value.toLowerCase();this.options.forEach((t=>{if("group"===t.type){t.children.forEach((t=>{const o=!t.label.toLowerCase().startsWith(e);Array.from(t.el.children).forEach((e=>e.hidden=o)),t.hidden=o}));const o=t.children.map((e=>e.hidden)).includes(!1);Array.from(t.el.children).forEach((e=>e.hidden=!o))}else{const o=!t.label.toLowerCase().startsWith(e);Array.from(t.el.children).forEach((e=>e.hidden=o))}}))}update(){this.updateSelections(),this.updateButton(),this.updateFilter()}}